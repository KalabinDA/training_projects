# Предсказание уровня удовлетворенности работников и оттока кадров
Требуется спрогнозировать удовлетворенность сотрудников и отток кадров чтобы минимизировать риски, связанные с уходом сотрудников. Для этого нужны две модели машинного обучения, соответствующие установленным критериям

## Цели исследования
* Изучить и обработать предоставленные данные для первой задачи
* Создать метрику SMAPE для оценки модели
* Обучить несколько моделей и выбрать лучшую модель для предсказания уровня удовлетворенности, удовлетворяющую запросу SMAPE не больше 15%
* Изучить важность признаков для модели, сделать рекомендации
* Изучить и обработать набор данных для второй задачи
* Составить портрет уволившегося сотрудника
* При необходимости расширить набор данных
* Обучить несколько моделей и выбрать лучшую модель для предсказания оттока кадров, показавшую ROC-AUC не менее 0,91
* Изучить важность признаков для модели, сделать рекомендации

## Ход исследования:

* Подготовка данных: загрузка и изучение информации о предоставленных датасетах.
* Предобработка данных: при необходимости изменение названий столбцов, изменение типов данных, обработка дубликатов.
* Исследовательский анализ данных: обработка выбросов и аномалий.
* Корреляционный анализ: определение взаимосвязи признаков.
* Выбор модели для задачи регрессии: создать метрику SMAPE для выбора лучшей модели, подобрать лучший тип модели и её гиперпараметры.
* Анализ важности признаков: выявить наиболее и наименее важные признаки для модели.
* Подготовка, предобработка и исследовательский анализ данных для задачи классификации.
* Анализ данных: описать портрет уволившегося сотрудника, определить влияет ли на него уровень удовлетворенности.
* Выбор модели для задачи классификации: подобрать лучший тип модели и её гиперпараметры для прогноза оттока сотрудников.
* Вывод: сделать выводы о моделях и их результатах работы, дать рекомендации HR отделу.

## Библиотеки: 
pandas, matplotlib, seaborn, sklearn, shap, phik, pipeline


## Вывод:

* Для обучения моделей было получено 5 датасетов: два с различными признаками работников компании, в том числе и целевыми признаками. Два с целевыми признаками для теста и один с входными признаками для теста. Всего 4000 обучающих и 2000 тестовых строк.
* В результате обработки данных были выявлены несколько пропусков, которые будут обработаны при дальнейшем исследовании, убраны пробелы и отсортированы в одинаковом порядке тренировочные данные
* Выяснилось, что тренировочные и тестовые данные распределены схожим образом, следовательно можно не бояться быстрого переобучения модели. Также был обнаружен признак с выбросами, зарплата, а значит стоит использовать робастные инструменты. В таких категориях как замечания и повышения за последний год имеется сильный дисбаланс
* При оценке корреляции как количественных, так и категориальных признаков мультиколлинеарность не была обнаружена, при этом некоторые признаки почти не влияют на целевой
*
    * Для оценки работы модели была реализована метрика SMAPE.
    * Предсказание уровня удовлетворенности является задачей регрессии, поэтому были выбраны модели линейной регресси и регрессионного дерева решений. Для * обработки пропусков были применены два метода: замена на самое часто встречающееся значение и на заглушку. Для защиты от выбросов помимо стандартного скейлера для обработки числовых признаков был использован робастный скейлер. Также для дерева решений подобраны гиперпараметры. Для поиска самой лучшей комбинации вышеперечисленных параметров был использован долгий, но максимально эффективный поиск по сетке, оценивающий требуемую метрику SMAPE.
    * В результате было выбрано дерево решений, замена пропусков на заглушки и робастный скейлер. Итоговая метрика на тестовых данных составила 13,6%, что соответствует поставленному условию не более 15%
* Для объяснения принятия решений моделью были рассчитаны значения Шепли. Согласно им больше всего на удовлетворенность влияют оценка руководителя и количество лет в компании. Наименьшее влияние оказывают повышение за последний месяц и отдел, в котором человек работает. Если оценка руководителя 3 и ниже, стоит присмотреться к такому работнику, скорее всего у него низкая удовлетворенность в компании.
* В тренировочных данных для второго исследования не было пропусков. Значения целевого признака были отсортированы в соответствии с тестовым набором входных признаков
*
    * В тестовые данные был добавлен признак удовлетворенности из предоставленного для прошлого исследования датасета, для тестовых данных предскажем этот признак лучшей регрессионной моделью.
    * Тренировочные данные распределены схожим образом с признаками из предыдущего исследования. Они похожи на тестовые, что позволяет не бояться переобучения. Как и раньше, имеются выбросы в зарплате, что подталкивает к использованию робастных инструментов.
    * В тренировочном и тестовом таргете наблюдается дисбаланс классов. Выбор ROC-AUC в качестве ключевой метрики является хорошим решением, она устойчива к дисбалансу.
* Предсказание ухода или не ухода сотрудника является задачей бинарной классификации. Для неё подойдут модели логистической регрессии, k ближайших соседей, опорных векторов и дерево решений - классификатор. Как и в прошлый раз, путем подбора стратегии обработки пропусков, скейлера и параметров моделей, а также с помощью подбора оптимального количества признаков, была найдена лучшая модель.
* Под заданный порог ROC-AUC на тестовых данных не менее 0,91 подошли дерево решений и метод опорных векторов. В результате дополнительной настройки параметров итоговое значение метрики достигло 0,93
* Как и в предыдущем случае, были найдены значения Шепли. Самое сильное влияние на отток кадров оказывает время, проведенное в кампании, удовлетворенность, оценка начальника и зарплата. Это подтверждает выводы о портрете уволившегося клиента на основе данных. Стоит пристально следить за удовлетворенностью сотрудников и отношениями в коллективе, особенно в первые годы. 