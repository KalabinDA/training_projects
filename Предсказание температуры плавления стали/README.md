# Предсказание температуры сплава для сталелитейного предприятия
Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Необходимо построить модель, которая будет её предсказывать. Заказчик хочет использовать разработанную модель для имитации технологического процесса.

## Цели исследования
* Изучить и обработать предоставленные данные.
* Обучить несколько моделей и выбрать лучшую модель для предсказания температуры сплава, удовлетворяющую запросу (показатель MAE не больше 6,8).
* Изучить важность признаков для модели, сделать рекомендации.

## Ход исследования:

* Подготовка данных: загрузка и изучение информации о предоставленных датасетах.
* Предобработка данных: изменение типов данных, обработка дубликатов, пропусков, создание новых признаков.
* Исследовательский анализ данных: обработка выбросов и аномалий.
* Корреляционный анализ: определение взаимосвязи признаков.
* Обучение модели: подобрать лучший тип модели и её гиперпараметры.
* Анализ важности признаков: выявить наиболее и наименее важные признаки для модели.
* Вывод: сделать выводы о модели и их результатах работы, дать рекомендации.

## Библиотеки: 
pandas, matplotlib, seaborn, sklearn, lightgbm, shap


## Вывод:

* Для обучения модели предсказания температуры были получены 7 таблиц с различными данными о техническом процессе. Две из них оказались бесполезны для данного исследования.
* Из оставшихся пяти таблиц были извлечены необходимые данные, а также созданы новые признаки и выделен целевой признак финальной температуры, который и нужно предсказать.
* В данных присутствовали  некорректные значения и пропуски. Некорректные и бесполезные значения были удалены, пропуски логично заполнены.
* Для оценки важности признаков был создан бесполезный признак-индикатор. 
* В результате получилось 2324 строк с готовыми к обучению данными.
* Данные распределены близко к нормальному, однако у большинства признаков имеются сильно выбивающиеся в большую сторону значения. 
* Многие процессы проводились без добавок и в некоторых случаях общее время было очень маленьким.
* Целевой признак имеет слабую корреляцию со входными. Сильнее всего он связан со временем нагрева, начальной температурой и двумя добавками.
* Данные были разделены для обучения и теста. Проводилась кросс-валидации на 3 фолда.
* Для обучения были выбраны три модели: метод ближайших соседей, дерево решений и градиентный бустинг.
* Достичь целевой метрики смогла только одна модель LGBMRegressor
* После анализа признаков были исключены те, что показали себя хуже случайно сгенерированного. Уже без них модель была обучена заново.
* Метрика этой модели на кросс-валидации составила 5.9618, что с запасом удовлетворяет требованиям.
* На тесте MAE составила 5.637, что почти равно кросс-валидационной метрике и означает надежность модели. Самыми важными признаками оказались время нагрева, общее время процесса и начальная температура. Чем выше начальная температура, время нагрева, и ниже общее время процесса, тем выше итоговая температура. Другие факторы из предоставленных данных влияют слабо или вовсе не оказывают эффекта на конечную температуру. При предсказании средних температур от 1570 до 1610 градусов модель показывает себя особенно хорошо, однако при увеличении и уменьшении температуры модель начинает заметно ошибаться. Для исправления необходимо собрать больше данных о процессах с высокими и низкими температурами.